<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Fate Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Jost:wght@400;500&display=swap" rel="stylesheet">
    <style>
        
        body {
            font-family: 'Jost', sans-serif;
        }
        .font-cinzel {
            font-family: 'Cinzel Decorative', cursive;
        }
        /* Shake animation */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
        }
        .shake {
            animation: shake 0.3s ease-in-out;
        }

        /* Glow effect for button */
        @keyframes glow {
            0% { box-shadow: 0 0 5px #fde047, 0 0 10px #fde047; }
            50% { box-shadow: 0 0 20px #facc15, 0 0 30px #facc15; }
            100% { box-shadow: 0 0 5px #fde047, 0 0 10px #fde047; }
        }
        .glow-on-hover {
            animation: glow 2.5s infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-purple-900 to-indigo-900 min-h-screen flex items-center justify-center p-5 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]">
    <div class="bg-slate-800/50 backdrop-blur-sm rounded-3xl shadow-2xl shadow-purple-500/20 p-8 max-w-lg w-full border border-purple-400/30">
        <h1 class="text-4xl font-cinzel font-bold text-center mb-2 text-yellow-300">Fate Calculator</h1>
        <p class="text-center text-purple-300 mb-8">Unveiling Your Ridiculous Destiny</p>

        <div class="mb-5">
            <label for="name" class="block text-purple-300 font-medium mb-2">Scribe Your Mortal Name:</label>
            <input
                type="text"
                id="name"
                placeholder="e.g., Bartholomew Stardust"
                class="w-full p-3 bg-gray-900/70 border border-purple-500/50 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"
            />
        </div>

        <div class="mb-6">
            <label for="dob" class="block text-purple-300 font-medium mb-2">Reveal Your Star-Chart Date:</label>
            <input
                type="text"
                id="dob"
                placeholder="dd-mm-yyyy"
                class="w-full p-3 bg-gray-900/70 border border-purple-500/50 rounded-lg text-white placeholder-gray-500 focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"
            />
        </div>

        <button
            id="calculateBtn"
            class="w-full bg-yellow-400 hover:bg-yellow-300 text-gray-900 font-bold py-3 rounded-lg transition duration-200 glow-on-hover text-lg"
        >
            Gaze into the Void ✨
        </button>

        <div id="loadingBarContainer" class="hidden w-full bg-gray-700 rounded-full mt-5">
            <div id="loadingBar" class="h-3 bg-gradient-to-r from-yellow-400 to-purple-500 rounded-full" style="width: 0%"></div>
        </div>

        <div id="message" class="mt-4 hidden p-3 rounded-lg font-bold"></div>

        <div id="results" class="mt-6 text-center">
            <p id="result" class="text-xl font-medium text-white mb-4"></p>
            <div id="lifeAdviceCard" class="mt-6 mb-5 p-4 border-2 border-dashed border-yellow-300/50 rounded-lg bg-purple-900/30 text-yellow-200 font-semibold hidden italic"></div>
             <p id="blinkCount" class="text-purple-300 text-md font-semibold mb-4"></p>
            <div id="milestones-container" class="hidden">
                <h2 class="font-cinzel text-2xl text-yellow-300 mt-6 mb-3">Cosmic Prophecies</h2>
                <ul id="milestones" class="list-none space-y-2 text-left"></ul>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>    
    <script>
        const nameInput = document.getElementById("name");
        const dobInput = document.getElementById("dob");
        const messageDiv = document.getElementById("message");
        const resultDiv = document.getElementById("result");
        const milestonesList = document.getElementById("milestones");
        const milestonesContainer = document.getElementById("milestones-container");
        const calculateBtn = document.getElementById("calculateBtn");
        const loadingBarContainer = document.getElementById("loadingBarContainer");
        const loadingBar = document.getElementById("loadingBar");
        const lifeAdviceCard = document.getElementById("lifeAdviceCard");
        const blinkElem = document.getElementById("blinkCount");

        const marriageMessages = [
            "നിനക്ക് വിവാഹമില്ല... ഫാമിലി വാട്സ്ആപ്പ് ഗ്രൂപ്പിലും പ്രതീക്ഷയില്ല!",
            "വിവാഹമോ? അതൊരു നിമിഷം നീളുന്ന പ്രഹസനം മാത്രം!",
            "വിവാഹമാണോ? എന്തു പറഞ്ഞാലും അതാണല്ലോ വിഷയം!",
            "വിവാഹം കൊണ്ട് പ്രയോജനമൊന്നുമില്ല, ചിലപ്പോൾ സൗജന്യ വൈഫൈ കിട്ടിയേക്കാം!",
            "നിൻ്റെ വിവാഹമെന്ന ഫയൽ ഒരിക്കലും സേവ് ചെയ്യപ്പെടുന്നില്ല!",
            "നിനക്ക് വിവാഹമോ? ആദ്യം സൗജന്യ വൈഫൈയെങ്കിലും കിട്ടട്ടെ!",
            "വിവാഹത്തെക്കുറിച്ച് ആലോചിക്കുമ്പോഴേക്കും ഒരു ബൈക്ക് വാങ്ങാനുള്ള സമയമായേക്കും!",
            "വിവാഹം നടക്കും, പക്ഷേ സീറ്റ് റിസർവേഷൻ പോലെയാണ്!",
            "നിനക്ക് വിവാഹമോ? ആദ്യം പണവും നല്ലൊരു സ്യൂട്ടും തയ്യാറാക്കൂ!",
            "വിവാഹത്തെക്കുറിച്ച് പറയുമ്പോൾ, ആദ്യം ആ വാട്സ്ആപ്പ് സ്റ്റാറ്റസ് ഒന്ന് മാറ്റൂ!",
            "വിവാഹമോ? ആദ്യം നെറ്റ്ഫ്ലിക്സ് സബ്സ്ക്രിപ്ഷൻ പുതുക്കൂ!",
            "നിൻ്റെ വിവാഹമോ? അതൊരു ഓൺലൈൻ ഹോളിഡേ പാക്കേജ് പോലെയാണ്!",
            "വിവാഹം നടക്കും, പക്ഷേ കുറച്ച് പേപ്പർ വർക്കുകൾ കൂടിയുണ്ട്!",
            "വിവാഹമോ? അതൊരു ഭരണപരമായ ജോലി പോലെ വിരസമാണ്!",
            "നിനക്ക് വിവാഹമോ? ആദ്യം കുറച്ച് ഹോംവർക്ക് ചെയ്യൂ!",
            "വിവാഹമെന്നത് ഒരു ഡെലിവറി ഓർഡർ പോലെയാണ്, എപ്പോൾ വേണമെങ്കിലും എത്താം!",
            "നിൻ്റെ വിവാഹം പ്ലാൻ ചെയ്തതുപോലെ തന്നെ നടക്കുമോ?",
            "വിവാഹം വരും, പക്ഷേ സ്ലോ മോഷനിൽ!",
            "വിവാഹമോ? ആദ്യം നിൻ്റെ ഫോൺ ചാർജ് ചെയ്യൂ!",
            "നിൻ്റെ വിവാഹമെന്നത് ഒരു വീഡിയോ ഗെയിം പോലെയാണ്, ഓരോ ലെവലും ബുദ്ധിമുട്ടേറിയതാണ്!",
        ];

        const deathMessages = [
            "മരണം ഉറപ്പാണ്, പക്ഷേ ഇപ്പോഴല്ല. അതുവരെ നെറ്റ്ഫ്ലിക്സിൽ എന്ത് കാണും?",
            "ഇനിയും കിടന്നുറങ്ങാതെ ജീവിതം ആസ്വദിക്കൂ, വയസ്സാകുമ്പോൾ ഉറങ്ങാൻ ധാരാളം സമയമുണ്ടാകും.",
            "വയസ്സായാൽ ചിലപ്പോൾ ഓർമ്മ പോയേക്കാം, പക്ഷേ ചായ കുടിക്കുന്നത് നിർത്താതിരിക്കാം.",
            "എല്ലാവർക്കും സമയമെത്തും, പക്ഷേ അതിനുമുമ്പ് കുറച്ച് നാടകം കണ്ടാലോ?",
            "പെട്ടെന്ന് മരിച്ചു പോകരുത്, വീട്ടിലെ വാട്സ്ആപ്പ് ഗ്രൂപ്പിലുള്ളവർ ഞെട്ടിപ്പോകും!",
            "ഇന്നലെ വരെ നല്ല സുഖമായിരുന്നില്ലേ? ബാക്കി വഴിയേ വരും.",
            "മരണവാർത്തയെത്തും, പക്ഷേ അതിനുമുൻപ് ഒരു ചായ കുടിക്കണം.",
            "വെറുതെ കിടക്കാതെ പാട്ടുപാടൂ, മരണം എപ്പോൾ വേണമെങ്കിലും വരാം.",
            "ഇനി വേദനകൾ ഉണ്ടാകില്ല, പക്ഷേ ഇപ്പോൾ കുറച്ച് വിഷമിക്കൂ.",
            "മരണം വരും, പക്ഷേ നാളത്തെ പാട്ട് കേട്ടിട്ട് പോകാം.",
            "അവസാനമായി എന്തെങ്കിലും പറയാനുണ്ടോ? അതിനുമുമ്പ് ഒരു കവിൾ ചായ കുടിക്കാം.",
            "ഇനിയും ഉറങ്ങാൻ തോന്നുന്നില്ലെങ്കിൽ, മരണം അടുത്തെത്തിയെന്ന് കരുതാം.",
            "കളിച്ചു നടക്കാൻ ഇനി അധികം സമയമില്ല, എന്നാലും ശ്രമം തുടരണം.",
            "മരണം ഒരു സ്റ്റോപ്പ് സിഗ്നൽ പോലെയാണ്, പക്ഷേ അതുവരെ ഓട്ടം തുടർന്നേ പറ്റൂ.",
            "ഇനി നിന്നെ കാണാൻ മരണശേഷം കോഴിക്കോട്ടേക്ക് വരാം.",
            "മരിക്കുന്നതിന് മുമ്പ് ഒരു ചായയെങ്കിലും വാങ്ങിത്തരണം.",
            "ഇനി പഴയ കഥകളൊക്കെ പറഞ്ഞ് മരണത്തെ സ്വാഗതം ചെയ്യാനൊരുങ്ങൂ.",
            "മരണം ഒരു കെട്ടുപാടാണ്, പക്ഷേ ആ യാത്രയിൽ നീ തനിച്ചായിരിക്കില്ല.",
            "ചിരിക്കാൻ ഇനിയും സമയമുണ്ട്, പക്ഷേ മരണം ഏത് നിമിഷവും വരാം.",
            "അവസാനം വന്നുചേരുന്നത് ഒരു നല്ല പാട്ടായിരിക്കട്ടെ.",
        ];

        const lifeAdvice = [
          { maxAge: 12, advice: "കുഞ്ഞേ, പാഠപുസ്തകം വായിക്കണം അല്ലേ? YouTube-ൽ മാത്രം കണ്ടു തീരില്ല." },
          { maxAge: 18, advice: "പഠനം കിട്ടില്ലേ? എങ്കിൽ Netflix സബ്സ്ക്രിപ്ഷൻ കുറക്കാൻ സമയമാണ്." },
          { maxAge: 30, advice: "വലിയ ആളായതല്ലേ? പണവും ജീവിതവും തമ്മിൽ പറ്റിപ്പോക്കാൻ പഠിക്കൂ." },
          { maxAge: 50, advice: "വയസായി, പക്ഷേ മതി, ബസ്സ് മതി… അതിലും അകന്നു പോവാൻ പഠിക്കൂ." },
          { maxAge: 80, advice: "നിനക്ക് അറിഞ്ഞ് പറയാം, ജീവിതം തക്കൂന്നു ആയാലും വണ്ടി ഓടിക്കുന്നപോലെ." },
          { maxAge: 200, advice: "കഴിഞ്ഞ കാലങ്ങളിലെ പണ്ടാരത്തിരികഥകളല്ലേ കേട്ടിട്ടുള്ളത്? ഇനി അതും മുട്ടിവയ്ക്കാം." }
        ];

        function showMessage(msg, type) {
            messageDiv.textContent = msg;
            messageDiv.className = `mt-4 p-3 rounded-lg font-bold text-white ${type === "error" ? "bg-red-500/80" : "bg-green-500/80"}`;
            messageDiv.classList.remove("hidden");
        }

        function getLifeAdvice(age) {
            for (const adviceObj of lifeAdvice) {
                if (age <= adviceObj.maxAge) {
                    return adviceObj.advice;
                }
            }
            return "ജീവിതം വലിയ കളിയാണ്, അത് ആസ്വദിക്കൂ!";
        }
        
        function fireConfetti() {
            var end = Date.now() + (2 * 1000);
            var colors = ['#fde047', '#a855f7', '#ffffff'];

            (function frame() {
              confetti({
                particleCount: 3,
                angle: 60,
                spread: 55,
                origin: { x: 0 },
                colors: colors
              });
              confetti({
                particleCount: 3,
                angle: 120,
                spread: 55,
                origin: { x: 1 },
                colors: colors
              });

              if (Date.now() < end) {
                requestAnimationFrame(frame);
              }
            }());
        }

        function showResults(userName, birthDate, years, months, days) {
            resultDiv.innerHTML = `<span class="font-cinzel text-yellow-300">Greetings, ${userName}!</span><br>The cosmos reveals you have orbited the sun for <span class="text-white font-bold">${years}</span> years, <span class="text-white font-bold">${months}</span> months, and <span class="text-white font-bold">${days}</span> days.`;

            const totalDays = years * 365 + months * 30 + days;
            const totalMinutes = totalDays * 24 * 60;
            const blinksPerMinute = 15;
            const totalBlinks = Math.round(totalMinutes * blinksPerMinute);
            
            blinkElem.textContent = `👁️ You've blinked approx. ${totalBlinks.toLocaleString()} times. A truly pointless statistic.`;
            
            const advice = getLifeAdvice(years);
            lifeAdviceCard.textContent = `📜 A Prophecy For You: ${advice}`;
            lifeAdviceCard.classList.remove("hidden");

            function randomBetween(min, max) {
               return Math.floor(Math.random() * (max - min + 1)) + min;
            }

            const milestones = [
                { label: "1st Solar Return", yearsToAdd: 1 },
                { label: "The Great Awakening (18th Return)", yearsToAdd: 18 },
                { label: "The 'Adulting' Illusion (21st Return)", yearsToAdd: 21 },
                { label: "Mid-life Cosmic Shift (50th Return)", yearsToAdd: 50 },
                { label: "The Centennial Star (100th Return)", yearsToAdd: 100 },
                { label: "Fated Union (Marriage)", yearsToAdd: randomBetween(25, 35) },
                { label: "Return to Stardust (Death)", yearsToAdd: randomBetween(75, 95) },
            ];

            milestonesList.innerHTML = "";
            milestonesContainer.classList.remove("hidden");

            milestones.forEach((ms) => {
                const milestoneDate = new Date(
                    birthDate.getFullYear() + ms.yearsToAdd,
                    birthDate.getMonth(),
                    birthDate.getDate()
                );
                const dateStr = milestoneDate.toLocaleDateString("en-GB", {day: 'numeric', month: 'long', year: 'numeric'});

                let msg = "";
                if (ms.label.includes("Fated Union")) {
                    const marriageMsg = marriageMessages[Math.floor(Math.random() * marriageMessages.length)];
                    msg = `<strong>${ms.label}:</strong> Around ${dateStr} <br> <span class="text-sm text-red-400 italic pl-4">- ${marriageMsg}</span>`;
                } else if (ms.label.includes("Return to Stardust")) {
                    const deathMsg = deathMessages[Math.floor(Math.random() * deathMessages.length)];
                    msg = `<strong>${ms.label}:</strong> Around ${dateStr} <br> <span class="text-sm text-red-400 italic pl-4">- ${deathMsg}</span>`;
                } else {
                    msg = `<strong>${ms.label}:</strong> ${dateStr}`;
                }

                const li = document.createElement("li");
                li.innerHTML = `⭐ ${msg}`;
                li.className = "text-purple-200 bg-gray-900/50 p-3 rounded-lg border-l-4 border-yellow-400";
                milestonesList.appendChild(li);
            });
            
            fireConfetti();
        }

        function calculateAge() {
            const userName = nameInput.value.trim();
            const dobStr = dobInput.value.trim();

            if (!userName) {
                showMessage("The stars demand a name!", "error");
                nameInput.classList.add("shake");
                setTimeout(() => nameInput.classList.remove("shake"), 500);
                return;
            }

            if (!dobStr) {
                showMessage("Your birth date is required by the cosmos.", "error");
                dobInput.classList.add("shake");
                setTimeout(() => dobInput.classList.remove("shake"), 500);
                return;
            }

            const dobPattern = /^(\d{2})-(\d{2})-(\d{4})$/;
            const match = dobStr.match(dobPattern);
            if (!match) {
                showMessage("The universe dislikes this date format. Use dd-mm-yyyy.", "error");
                dobInput.classList.add("shake");
                setTimeout(() => dobInput.classList.remove("shake"), 500);
                return;
            }

            const day = parseInt(match[1], 10);
            const month = parseInt(match[2], 10) - 1;
            const year = parseInt(match[3], 10);

            const birthDate = new Date(year, month, day);
            if (
                birthDate.getFullYear() !== year ||
                birthDate.getMonth() !== month ||
                birthDate.getDate() !== day
            ) {
                showMessage("That's not a real date, you silly mortal.", "error");
                dobInput.classList.add("shake");
                setTimeout(() => dobInput.classList.remove("shake"), 500);
                return;
            }

            const now = new Date();
            if (birthDate > now) {
                showMessage("Are you a time traveler? Enter a date from the past.", "error");
                dobInput.classList.add("shake");
                setTimeout(() => dobInput.classList.remove("shake"), 500);
                return;
            }

            messageDiv.classList.add("hidden");
            resultDiv.textContent = "";
            milestonesList.innerHTML = "";
            milestonesContainer.classList.add("hidden");
            lifeAdviceCard.classList.add("hidden");
            blinkElem.textContent = "";
            loadingBarContainer.classList.remove("hidden");
            loadingBar.style.width = "0%";
            calculateBtn.disabled = true;
            calculateBtn.textContent = "Consulting the Oracle...";

            let width = 0;
            const interval = setInterval(() => {
                if (width >= 100) {
                    clearInterval(interval);
                    loadingBarContainer.classList.add("hidden");
                    calculateBtn.disabled = false;
                    calculateBtn.textContent = "Gaze into the Void ✨";
                    
                    let years = now.getFullYear() - birthDate.getFullYear();
                    let months = now.getMonth() - birthDate.getMonth();
                    let days = now.getDate() - birthDate.getDate();

                    if (days < 0) {
                        months--;
                        days += new Date(now.getFullYear(), now.getMonth(), 0).getDate();
                    }
                    if (months < 0) {
                        years--;
                        months += 12;
                    }

                    showResults(userName, birthDate, years, months, days);
                } else {
                    width += 2;
                    loadingBar.style.width = width + "%";
                }
            }, 40);
        }

        calculateBtn.addEventListener("click", calculateAge);
    </script>
</body>
</html>